<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Funcionarios</title>
    <link rel="stylesheet" href="./visualizar_funcionario/visualizar_funcionario.css">
    <script src="../js/scrool.js"></script>
    <script src="./excluirUser.js"></script>
</head>

<% if(urid.Tipo=="ofoda"){ %>
    <%- include('../views/navbar') -%>
    <% }else{%>
    <%- include('../views/navbarVendedor') -%>
    <% } %> 

<body id="body">
        <span id="titu" class="tit">Visualizar Funcion√°rios</span>
    <div class="center">
        <table id="table" class="scroll">
            <thead>
            <tr class="cabeca">
                <th id="th"><span class="tb_ini">ID</span></th>
                <th id="th"><span class="i2">Nome</span></th>
                <th id="th"><span class="i3">CPF</span></th>
                <th id="th"><span class="tb_final">Contato</span></th>
            </tr>
        </thead>
        <tbody id="paginated-list" class="corpo">
            <% for(var i = 0; i< Fun.length; i++) {%>
                <tr>
                    <td id="td" ><%= Fun[i].IdFun%></td>
                    <td id="td" ><%= Fun[i].Nome%></td>
                    <td id="td" ><%= Fun[i].Cpf%></td>
                    <td id="td" class="cont"><%= Fun[i].Contato%> 
                    <button class="delete" id=<%=Fun[i].IdFun%> onclick="deleteUser(this.id)"></button>
                    <button class="modify"  id=<%=Fun[i].IdFun%> onclick="window.location.href='/AtualizarFuncionario?id=<%=Fun[i].IdFun%>'"></button></td>
                </tr>
            <%}%>
</tbody>
        </table>
        <nav class="pagination-container">
                <button class="pagination-button" id="prev-button" aria-label="Previous page" title="Previous page">
                  &lt;
                </button>
            
                <div id="pagination-numbers">
            
                </div>
            
                <button class="pagination-button" id="next-button" aria-label="Next page" title="Next page">
                  &gt;
                </button>
</body>
</html>

<script>
        const paginationNumbers = document.getElementById("pagination-numbers");
        const paginatedList = document.getElementById("paginated-list");
        const listItems = paginatedList.querySelectorAll("td");
        const nextButton = document.getElementById("next-button");
        const prevButton = document.getElementById("prev-button");
        
        const paginationLimit = 45;
        const pageCount = Math.ceil(listItems.length / paginationLimit);
        let currentPage = 1;
        
        const disableButton = (button) => {
          button.classList.add("disabled");
          button.setAttribute("disabled", true);
        };
        
        const enableButton = (button) => {
          button.classList.remove("disabled");
          button.removeAttribute("disabled");
        };
        
        const handlePageButtonsStatus = () => {
          if (currentPage === 1) {
            disableButton(prevButton);
          } else {
            enableButton(prevButton);
          }
        
          if (pageCount === currentPage) {
            disableButton(nextButton);
          } else {
            enableButton(nextButton);
          }
        };
        
        const handleActivePageNumber = () => {
          document.querySelectorAll(".pagination-number").forEach((button) => {
            button.classList.remove("active");
            const pageIndex = Number(button.getAttribute("page-index"));
            if (pageIndex == currentPage) {
              button.classList.add("active");
            }
          });
        };
        
        const appendPageNumber = (index) => {
          const pageNumber = document.createElement("button");
          pageNumber.className = "pagination-number";
          pageNumber.innerHTML = index;
          pageNumber.setAttribute("page-index", index);
          pageNumber.setAttribute("aria-label", "Page " + index);
        
          paginationNumbers.appendChild(pageNumber);
        };
        
        const getPaginationNumbers = () => {
          for (let i = 1; i <= pageCount; i++) {
            appendPageNumber(i);
          }
        };
        
        const setCurrentPage = (pageNum) => {
          currentPage = pageNum;
        
          handleActivePageNumber();
          handlePageButtonsStatus();
          
          const prevRange = (pageNum - 1) * paginationLimit;
          const currRange = pageNum * paginationLimit;
        
          listItems.forEach((item, index) => {
            item.classList.add("hidden");
            if (index >= prevRange && index < currRange) {
              item.classList.remove("hidden");
            }
          });
        };
        
        window.addEventListener("load", () => {
          getPaginationNumbers();
          setCurrentPage(1);
        
          prevButton.addEventListener("click", () => {
            setCurrentPage(currentPage - 1);
          });
        
          nextButton.addEventListener("click", () => {
            setCurrentPage(currentPage + 1);
          });
        
          document.querySelectorAll(".pagination-number").forEach((button) => {
            const pageIndex = Number(button.getAttribute("page-index"));
        
            if (pageIndex) {
              button.addEventListener("click", () => {
                setCurrentPage(pageIndex);
              });
            }
          });
        });
        
        </script>
